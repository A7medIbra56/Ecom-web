{% extends "base/admin/admin.html" %}

<!-- Additional Data For Head -->
{% block page_head %}

{% load static %}
{% load compress %}

<title>Dashboard</title>

{% endblock page_head %}

<!-- Page Specific Local CSS Imports -->
{% block page_css %}

{% compress css %}
<link rel="stylesheet" type="text/x-scss" href="{% static 'admin_dashboard/scss/home.scss' %}">
{% endcompress %}

{% endblock page_css %}

<!-- Page Specific Local JavaScript Imports -->
{% block page_js %}
<script src="{% static 'admin_dashboard/js/chart.js'%}"></script>
{% endblock page_js %}

{% block page_body %}

<!-- start home dashboard  header -->
<div class="dashboard__header row align-items-center">

    <div class="col dashboard__header-text">

      <h1 class="dashboard-title mb-0">Dashboard</h1>
      <p class="dashboard-subtitle text-muted mb-0">Monitor your store's progress to increase your sales.</p>
    
    </div>

    <div class="col-auto dashboard__header-export">

      <button class="btn d-flex align-items-center">
        
        <i class="bi bi-box-arrow-up"></i>
        Export

      </button>
    
    </div>
</div>
<!-- end home dashboard header -->

<!-- start cards stats gallery -->
<div class="cards-gallery">

  <div class="dashboard__card">

      <div class="card__header">
        
        <span class="card-header__container">
          <!-- <i class="dashboard__card-icon bi bi-pie-chart"></i> -->
          
          <svg class="dashboard__card-icon" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.0001 20.1897V28.0097C15.0005 28.0774 14.9866 28.1445 14.9591 28.2065C14.9317 28.2685 14.8914 28.324 14.841 28.3692C14.7905 28.4145 14.731 28.4485 14.6664 28.469C14.6018 28.4896 14.5336 28.4962 14.4663 28.4884C12.2539 28.2167 10.1547 27.3574 8.38679 25.9999C6.61887 24.6424 5.24677 22.8362 4.4131 20.769C4.38818 20.7061 4.37685 20.6387 4.37986 20.5712C4.38287 20.5036 4.40016 20.4375 4.43057 20.3771C4.46098 20.3168 4.50384 20.2635 4.55632 20.2209C4.6088 20.1783 4.66971 20.1473 4.73504 20.1299L12.2857 18.1025C12.3824 18.0771 12.4845 18.0826 12.5779 18.1183C12.6713 18.1539 12.7511 18.2178 12.8063 18.3011C13.2635 18.9625 13.9158 19.4646 14.6721 19.7373C14.7673 19.7689 14.8501 19.8295 14.9089 19.9107C14.9678 19.9919 14.9997 20.0895 15.0001 20.1897ZM15.9647 3.68094C15.8384 3.67999 15.7131 3.70405 15.5961 3.75174C15.4791 3.79944 15.3727 3.86981 15.283 3.95881C15.1934 4.04781 15.1222 4.15368 15.0736 4.27032C15.0251 4.38695 15.0001 4.51204 15.0001 4.63838V11.3405C14.9982 11.5923 15.0963 11.8346 15.2729 12.0141C15.4495 12.1937 15.6901 12.2957 15.942 12.298C16.8462 12.2941 17.7226 12.6102 18.4161 13.1905C19.1096 13.7708 19.5755 14.5777 19.7311 15.4685C19.8868 16.3592 19.7222 17.2763 19.2666 18.0574C18.811 18.8385 18.0937 19.4331 17.2417 19.7361C17.1466 19.768 17.0639 19.8289 17.0052 19.9103C16.9466 19.9917 16.915 20.0894 16.915 20.1897V28.0097C16.9145 28.0773 16.9284 28.1443 16.9558 28.2062C16.9832 28.2681 17.0233 28.3235 17.0736 28.3687C17.124 28.414 17.1833 28.448 17.2478 28.4686C17.3122 28.4893 17.3803 28.496 17.4475 28.4884C20.6017 28.1153 23.4939 26.5506 25.532 24.1146C27.5701 21.6785 28.5998 18.5555 28.4102 15.3851C28.2207 12.2146 26.8263 9.23646 24.5126 7.06056C22.1989 4.88467 19.1408 3.6756 15.9647 3.68094ZM12.1349 15.8273C12.1795 15.2618 12.3491 14.7132 12.6316 14.2212V14.2128C12.7265 14.049 12.7706 13.8607 12.7585 13.6717C12.7463 13.4828 12.6784 13.3017 12.5634 13.1513C12.4829 13.0478 12.3828 12.9612 12.2689 12.8964L6.48477 9.55248C6.37579 9.48964 6.25549 9.44889 6.13075 9.43256C6.00602 9.41623 5.87928 9.42465 5.7578 9.45733C5.63632 9.49001 5.52246 9.5463 5.42275 9.623C5.32303 9.6997 5.23941 9.7953 5.17666 9.90434C3.78371 12.3168 3.2393 15.1265 3.63038 17.8847C3.63961 17.952 3.66306 18.0166 3.69918 18.0741C3.7353 18.1317 3.78326 18.1809 3.83986 18.2185C3.89647 18.256 3.96042 18.2811 4.02748 18.2921C4.09454 18.3031 4.16316 18.2996 4.22879 18.282L11.795 16.2474C11.8888 16.2215 11.9722 16.1672 12.0339 16.092C12.0957 16.0168 12.1326 15.9244 12.1397 15.8273H12.1349Z" fill="white"/>
            </svg>
            
            
        </span>
        <h3 class="dashboard__card-title">Total Sales</h3>

      </div>

      <p class="dashboard__card-value">{{statistics.get_total_sales}}</p>

      <p class="dashboard__card-change">
          <span class="percent {{statistics.sales_growth.0}}">{% if statistics.sales_growth.0 != 'neutral' %}<i class="bi bi-arrow-{{ statistics.sales_growth.0 }}"></i>{%endif%} {{ statistics.sales_growth.1 }}% </span>
          
          <span class="text">
            vs last 7 days
          </span>
          
      </p>
  
  </div>

  <div class="dashboard__card">

    <div class="card__header">
        
      <span class="card-header__container">
        <svg class="dashboard__card-icon" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.142 18.4973C8.14525 18.5622 8.13527 18.627 8.11267 18.6879C8.09007 18.7487 8.05532 18.8044 8.01054 18.8514C7.96576 18.8984 7.91188 18.9358 7.85218 18.9614C7.79248 18.9869 7.72821 19 7.66328 19H2.38296C2.16686 19.0003 1.957 18.9275 1.78751 18.7934C1.61803 18.6594 1.49888 18.4719 1.44945 18.2615C1.41867 18.1175 1.42009 17.9685 1.4536 17.8251C1.48712 17.6818 1.55191 17.5476 1.64333 17.4321C2.48805 16.3119 3.60884 15.4299 4.89626 14.8722C4.33103 14.3568 3.89753 13.7136 3.63204 12.9962C3.36655 12.2789 3.27681 11.5084 3.37034 10.7492C3.46387 9.99008 3.73794 9.26439 4.1696 8.63295C4.60126 8.0015 5.17794 7.48268 5.85134 7.11994C6.52475 6.7572 7.27527 6.5611 8.04004 6.54806C8.80482 6.53502 9.56159 6.70542 10.247 7.045C10.9323 7.38457 11.5264 7.88343 11.9793 8.4998C12.4322 9.11616 12.7309 9.83208 12.8502 10.5876C12.8657 10.6892 12.8475 10.793 12.7984 10.8834C12.7494 10.9737 12.6722 11.0455 12.5786 11.0879C11.2506 11.7018 10.1259 12.6828 9.33726 13.9151C8.54861 15.1473 8.1289 16.5795 8.12764 18.0425C8.12764 18.1957 8.12764 18.3465 8.142 18.4973ZM29.9239 17.4309C29.0812 16.312 27.9629 15.4305 26.6782 14.8722C27.2434 14.3568 27.6769 13.7136 27.9424 12.9962C28.2079 12.2789 28.2976 11.5084 28.2041 10.7492C28.1106 9.99008 27.8365 9.26439 27.4048 8.63295C26.9732 8.0015 26.3965 7.48268 25.7231 7.11994C25.0497 6.7572 24.2992 6.5611 23.5344 6.54806C22.7696 6.53502 22.0128 6.70542 21.3275 7.045C20.6421 7.38457 20.0481 7.88343 19.5951 8.4998C19.1422 9.11616 18.8435 9.83208 18.7242 10.5876C18.7088 10.6892 18.727 10.793 18.776 10.8834C18.8251 10.9737 18.9022 11.0455 18.9959 11.0879C20.3238 11.7018 21.4485 12.6828 22.2372 13.9151C23.0258 15.1473 23.4455 16.5795 23.4468 18.0425C23.4468 18.1957 23.4468 18.3465 23.4324 18.4973C23.4292 18.5622 23.4392 18.627 23.4618 18.6879C23.4844 18.7487 23.5191 18.8044 23.5639 18.8514C23.6087 18.8984 23.6625 18.9358 23.7222 18.9614C23.7819 18.9869 23.8462 19 23.9111 19H29.1915C29.4076 19.0003 29.6174 18.9275 29.7869 18.7934C29.9564 18.6594 30.0755 18.4719 30.125 18.2615C30.156 18.1173 30.1545 17.9679 30.1208 17.8243C30.087 17.6807 30.0219 17.5463 29.9299 17.4309H29.9239ZM19.2723 22.5988C20.2256 21.8687 20.9262 20.8582 21.2756 19.7094C21.625 18.5606 21.6056 17.3311 21.2201 16.1939C20.8347 15.0567 20.1026 14.0688 19.1267 13.3692C18.1508 12.6695 16.9802 12.2933 15.7794 12.2933C14.5787 12.2933 13.4081 12.6695 12.4322 13.3692C11.4563 14.0688 10.7242 15.0567 10.3388 16.1939C9.95332 17.3311 9.93392 18.5606 10.2833 19.7094C10.6327 20.8582 11.3332 21.8687 12.2865 22.5988C10.5949 23.3317 9.18235 24.587 8.2557 26.1808C8.17165 26.3264 8.12741 26.4915 8.12742 26.6596C8.12743 26.8277 8.17169 26.9928 8.25575 27.1384C8.33981 27.2839 8.46071 27.4048 8.60629 27.4888C8.75187 27.5728 8.917 27.617 9.08509 27.617H22.4893C22.6574 27.617 22.8226 27.5728 22.9681 27.4888C23.1137 27.4048 23.2346 27.2839 23.3187 27.1384C23.4027 26.9928 23.447 26.8277 23.447 26.6596C23.447 26.4915 23.4028 26.3264 23.3187 26.1808C22.3901 24.586 20.9749 23.3306 19.2807 22.5988H19.2723Z" fill="white"/>
          </svg>
      </span>

      <h3 class="dashboard__card-title">Customers</h3>

    </div>

      <p class="dashboard__card-value">{{statistics.get_total_customers}}</p>

      <!-- <p class="dashboard__card-change">

        <span class="percent positive"><i class="bi bi-arrow-up"></i> 90% </span>
        
        <span class="text">
          vs last 7 days
        </span>
        
      </p> -->

  </div>

  <div class="dashboard__card">
    
    <div class="card__header">
    
      <span class="card-header__container">

        <svg class="dashboard__card-icon" viewBox="0 0 31 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M27.8412 7.85411C27.7513 7.74656 27.639 7.66005 27.512 7.6007C27.385 7.54135 27.2465 7.5106 27.1064 7.51062H7.79947L7.07181 3.50969C7.03173 3.28908 6.9155 3.08953 6.74337 2.94584C6.57124 2.80215 6.35414 2.72342 6.12992 2.72339H3.17022C2.91628 2.72339 2.67275 2.82426 2.4932 3.00382C2.31364 3.18337 2.21277 3.4269 2.21277 3.68084C2.21277 3.93477 2.31364 4.1783 2.4932 4.35785C2.67275 4.53741 2.91628 4.63828 3.17022 4.63828H5.32447L8.38351 21.4283C8.47362 21.9263 8.69368 22.3916 9.02141 22.7771C8.56907 23.1996 8.24259 23.7391 8.07816 24.3358C7.91373 24.9326 7.91777 25.5632 8.08985 26.1577C8.26193 26.7523 8.59531 27.2876 9.05304 27.7042C9.51076 28.1209 10.0749 28.4026 10.683 28.5182C11.2911 28.6338 11.9193 28.5787 12.498 28.3591C13.0766 28.1394 13.5832 27.7638 13.9614 27.2738C14.3396 26.7839 14.5748 26.1988 14.6408 25.5833C14.7068 24.9679 14.601 24.3462 14.3352 23.7872H19.7711C19.5569 24.2356 19.4461 24.7264 19.4468 25.2234C19.4468 25.8862 19.6433 26.5341 20.0116 27.0851C20.3798 27.6362 20.9032 28.0657 21.5155 28.3194C22.1278 28.573 22.8016 28.6394 23.4516 28.5101C24.1017 28.3808 24.6988 28.0616 25.1674 27.5929C25.6361 27.1243 25.9552 26.5272 26.0845 25.8771C26.2139 25.2271 26.1475 24.5533 25.8939 23.941C25.6402 23.3287 25.2107 22.8053 24.6596 22.4371C24.1085 22.0689 23.4607 21.8723 22.7979 21.8723H11.2092C10.985 21.8723 10.7679 21.7936 10.5957 21.6499C10.4236 21.5062 10.3074 21.3066 10.2673 21.086L9.8879 19H23.7709C24.4435 18.9999 25.0948 18.7637 25.6112 18.3326C26.1276 17.9015 26.4763 17.3029 26.5965 16.6411L28.0519 8.63921C28.0765 8.50091 28.0704 8.35888 28.034 8.2232C27.9976 8.08751 27.9318 7.9615 27.8412 7.85411ZM12.7447 25.2234C12.7447 25.5074 12.6605 25.7851 12.5026 26.0213C12.3448 26.2575 12.1205 26.4415 11.8581 26.5502C11.5957 26.6589 11.3069 26.6874 11.0283 26.632C10.7497 26.5765 10.4938 26.4398 10.293 26.2389C10.0921 26.0381 9.95535 25.7822 9.89994 25.5036C9.84452 25.225 9.87296 24.9362 9.98166 24.6738C10.0904 24.4114 10.2744 24.1871 10.5106 24.0293C10.7468 23.8714 11.0245 23.7872 11.3085 23.7872C11.6894 23.7872 12.0547 23.9385 12.324 24.2079C12.5934 24.4772 12.7447 24.8425 12.7447 25.2234ZM24.234 25.2234C24.234 25.5074 24.1498 25.7851 23.992 26.0213C23.8342 26.2575 23.6099 26.4415 23.3475 26.5502C23.085 26.6589 22.7963 26.6874 22.5177 26.632C22.2391 26.5765 21.9832 26.4398 21.7824 26.2389C21.5815 26.0381 21.4447 25.7822 21.3893 25.5036C21.3339 25.225 21.3623 24.9362 21.471 24.6738C21.5797 24.4114 21.7638 24.1871 22 24.0293C22.2362 23.8714 22.5138 23.7872 22.7979 23.7872C23.1788 23.7872 23.5441 23.9385 23.8134 24.2079C24.0827 24.4772 24.234 24.8425 24.234 25.2234Z" fill="white"/>
          </svg>
          
      </span>

      <h3 class="dashboard__card-title">Products</h3>

    </div>

      <p class="dashboard__card-value">{{statistics.get_total_products}}</p>

      <!-- <p class="dashboard__card-change">

        <span class="percent negative"><i class="bi bi-arrow-down"></i> 88% </span>
        
        <span class="text">
          vs last 7 days
        </span>
        
      </p> -->

  </div>

  <div class="dashboard__card">

    <div class="card__header">

      <span class="card-header__container">

        <svg class="dashboard__card-icon" viewBox="0 0 31 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M15.4468 3.68091C12.9851 3.68091 10.5786 4.4109 8.53174 5.77857C6.48487 7.14625 4.88953 9.09017 3.94746 11.3645C3.00539 13.6389 2.7589 16.1415 3.23917 18.556C3.71943 20.9704 4.90487 23.1882 6.64559 24.9289C8.38631 26.6697 10.6041 27.8551 13.0186 28.3354C15.433 28.8156 17.9356 28.5691 20.21 27.6271C22.4844 26.685 24.4283 25.0897 25.796 23.0428C27.1636 20.9959 27.8936 18.5895 27.8936 16.1277C27.8901 12.8277 26.5777 9.66382 24.2442 7.33034C21.9107 4.99687 18.7468 3.68439 15.4468 3.68091ZM16.883 21.8724H16.4043V22.8298C16.4043 23.0838 16.3034 23.3273 16.1238 23.5069C15.9443 23.6864 15.7007 23.7873 15.4468 23.7873C15.1929 23.7873 14.9494 23.6864 14.7698 23.5069C14.5902 23.3273 14.4894 23.0838 14.4894 22.8298V21.8724H12.5745C12.3205 21.8724 12.077 21.7715 11.8975 21.592C11.7179 21.4124 11.617 21.1689 11.617 20.915C11.617 20.661 11.7179 20.4175 11.8975 20.2379C12.077 20.0584 12.3205 19.9575 12.5745 19.9575H16.883C17.2639 19.9575 17.6292 19.8062 17.8985 19.5369C18.1678 19.2675 18.3192 18.9022 18.3192 18.5213C18.3192 18.1404 18.1678 17.7751 17.8985 17.5058C17.6292 17.2365 17.2639 17.0852 16.883 17.0852H14.0106C13.1219 17.0852 12.2695 16.7321 11.6411 16.1037C11.0126 15.4752 10.6596 14.6229 10.6596 13.7341C10.6596 12.8453 11.0126 11.993 11.6411 11.3645C12.2695 10.7361 13.1219 10.383 14.0106 10.383H14.4894V9.42559C14.4894 9.17166 14.5902 8.92813 14.7698 8.74857C14.9494 8.56902 15.1929 8.46814 15.4468 8.46814C15.7007 8.46814 15.9443 8.56902 16.1238 8.74857C16.3034 8.92813 16.4043 9.17166 16.4043 9.42559V10.383H18.3192C18.5731 10.383 18.8166 10.4839 18.9962 10.6635C19.1757 10.843 19.2766 11.0866 19.2766 11.3405C19.2766 11.5944 19.1757 11.8379 18.9962 12.0175C18.8166 12.1971 18.5731 12.2979 18.3192 12.2979H14.0106C13.6297 12.2979 13.2645 12.4492 12.9951 12.7186C12.7258 12.9879 12.5745 13.3532 12.5745 13.7341C12.5745 14.115 12.7258 14.4803 12.9951 14.7496C13.2645 15.019 13.6297 15.1703 14.0106 15.1703H16.883C17.7717 15.1703 18.6241 15.5233 19.2525 16.1518C19.881 16.7802 20.234 17.6326 20.234 18.5213C20.234 19.4101 19.881 20.2624 19.2525 20.8909C18.6241 21.5193 17.7717 21.8724 16.883 21.8724Z" fill="white"/>
          </svg>
          
      </span>

      <h3 class="dashboard__card-title">Revenue</h3>
    </div>

    <p class="dashboard__card-value">${{statistics.get_total_revenue}}</p>

    <p class="dashboard__card-change">
      <span class="percent {{statistics.revenue_growth.0}}">{% if statistics.revenue_growth.0 == 'neutral' %}<i class="bi bi-arrow-{{ statistics.revenue_growth.0 }}"></i>{%endif%} {{ statistics.revenue_growth.1 }}% </span>
      
      <span class="text">
        vs last 7 days
      </span>
      
    </p>

  </div>

  

</div>
<!-- end cards stats gallery -->

<!-- start chart and products -->
<div class="main">

  <div class="chart">
    <h3 class="chart-title">Total Revenue</h3>
    <h3 class="chart-total-value">${{statistics.get_total_revenue}}</h3>
    <p class="chart-subtitle">You gained <span class="chart-gain">+${{monthly_revenue}}</span> this month</p>
    <canvas id="revenueChart"></canvas>
  </div>

  <div class="products-for-approval">

    <div class="header">

      <div class="text">
        <h3 class="header-title">Products for Approval</h3>
        <p class="header-subtitle">Total {{statistics.get_total_products_pending_approval}} products</p>
      </div>

      <div class="link">
        <a href="{% url 'admin_dashboard:product_approve_list'%}" class="link-text">Show All</a>
        <i class="bi bi-arrow-right"></i>
      </div>
    
    </div>

    <div class="body">

      <ul class="products">

            {% for product in products_for_approval %}

            <li class="product">
              <img src="{{product.get_thumbnail}}" alt="{{product.title}} image" class="product-image">
              <!-- <img src="/media/uploads/bricks.png" alt="Bricks" class="product-image"> -->

              <div class="product-info">

                  <p class="product-name">{{product.title}}</p>
                  <p class="product-id">Item: #{{product.id}}</p>

              </div>

              <a href="{% url 'admin_dashboard:product_approve' product.id%}" class="product-link">View Details</a>
            </li>

            {% endfor %}
        </ul>

    </div>
  </div>

</div>
<!-- end chart and products --> 

<!-- start support tickets table -->
<div class="tickets">

  <div class="dashboard__header row align-items-center">

    <div class="col dashboard__header-text">

      <h1 class="dashboard-title mb-0">Recent support tickets</h1>
      <p class="dashboard-subtitle text-muted mb-0">Total {{support_tickets | length}} recent support tickets</p>
    
    </div>

    <div class="dashboard__header-actions">

      <!-- show all btn -->
      <div class="show-all">
        
        <a href="{% url 'admin_dashboard:support_list' %}" class="btn">
          Show all
          <i class="bi bi-arrow-right"></i>
        </a>
      </div>

  </div>


</div>
  
  {% if support_tickets %}
    <div class="table-wrapper">
      
      <table class="table table--tickets">
          <thead>
              <tr>
                  <th>ID</th>
                  <th>Name of User</th>
                  <th>Date</th>
                  <th>Subject</th>
                  <th>Status</th>
                  <th>Actions</th>
              </tr>
          </thead>
          <tbody>

              {% for thread in support_tickets %}
              <tr>
                  <td class="thread-id">#{{ thread.id }}</td>
                  
                  <td class="user">

                    <div class="user-info">

                      <img src="../../../media/uploads/vendor.png" alt="Icon" class="product-icon">
                      
                      <div>
                          <p class="name">
                            {% if thread.user %}
                            {{ thread.user }}

                            {% elif thread.vendor %}

                            {{thread.vendor.user}}
                            
                            {% endif %}
                          </p>
                      </div>
                      
                    </div>

                  </td>
                  

                  <td>{{ thread.created_at|date:"M d, Y" }}</td>
                  
                  <td>{{ thread.subject }}</td>
                  
                  <td class="status">
                    {% if thread.status == 'open' %}
                        <p class="stat stat--open">{{ thread.status|title }}</p>
                    {% elif thread.status == 'in_progress' %}
                        <p class="stat stat--in-progress">{{ thread.status|title }}</p>
                    {% elif thread.status == 'closed' %}
                        <p class="stat stat--closed">{{ thread.status|title }}</p>
                    {% elif thread.status == 'awiating_vendor_reply' %}
                        <p class="stat stat--awaiting-vendor-reply">{{ thread.status|title }}</p>
                    {% elif thread.status == 'awiating_admin_reply' %}
                        <p class="stat stat--awaiting-admin-reply">{{ thread.status|title }}</p>
                    {% elif ticket.status == 'awiating_customer_reply' %}
                        <p class="stat stat--awaiting-customer-reply">{{ thread.status|title }}</p>
                    {% else %}
                        <p class="stat stat--unknown">{{ thread.status|title }}</p>
                    {% endif %}
                  </td>

                  <td>
                      <!-- <a href="{% url 'admin_dashboard:ticket_detail' thread.id%}" class="view-link view-link--view">
                          View
                          <i class="bi bi-eye"></i>
                        </a> -->
                        
                        <a href="{% url 'admin_dashboard:ticket_detail' thread.id%}" class="view-link view-link--reply">
                          Reply
                          <i class="bi bi-reply"></i>

                      </a>
                  </td>

              </tr>

              {% endfor %}

          </tbody>
      </table>

    </div>

  {% else %}

  <h1>no support tickets</h1>

  {% endif %}

</div>
<!-- end support tickets table -->

{% endblock page_body %}

{% block additional_dom_scripts %}

{% endblock additional_dom_scripts %}